# `create_phased_vcf.py`

![Python](https://img.shields.io/badge/python-3.x-blue.svg)
![License](https://img.shields.io/badge/license-GPL--3.0-blue)

ðŸ”— [`create_phased_vcf.py`](./create_phased_vcf.py)

**Version:** 1.0  
**Author:** Rafael Nafikov  
**Date:** 2025-06-27

---

## Table of Contents
- [Folder Structure](#folder-structure)
- [Overview](#overview)
- [Requirements](#requirements)
- [Usage](#usage)
- [Arguments](#arguments)
- [Input Files](#input-files)
- [Output Files](#output-files)
- [Example](#example)
- [License](#license)
- [Support](#support)

---

## Folder Structure

```
phased_genotypes_to_VCF/
â”œâ”€â”€ create_phased_vcf.py
â”œâ”€â”€ input_files
â”‚Â Â  â”œâ”€â”€ 1000_Genomes_Project_chr16_unphased.vcf.gz
â”‚Â Â  â”œâ”€â”€ chr16_SNV_genomic_positions_B38.txt
â”‚Â Â  â””â”€â”€ haplotype_sequences.txt
â”œâ”€â”€ output_files
â”‚Â Â  â”œâ”€â”€ HaploGI_phased_WGS_data.log
â”‚Â Â  â””â”€â”€ HaploGI_phased_WGS_data.vcf
â””â”€â”€ README.md
```

3 directories, 7 files

Folders containing input and output files are zipped to save space.

---

## Overview

`create_phased_vcf.py` is a Python utility to augment an unphased whole-genome sequencing (WGS) VCF file with phased genotype information. The script leverages haplotype sequences generated by HaploGI to infer phased genotypes, while retaining original genotypes when phasing is not possible.

The output is a valid, filtered, and augmented VCF file compatible with standard bioinformatics tools, accompanied by a log of the augmentation process.

---

## Requirements

- Python 3.x  
- No external dependencies (standard library only)

---

## Usage

Run the script from the command line with the required inputs:

```bash
python create_phased_vcf.py \
        --haplotypes haplotype_sequences.txt \
        --positions SNV_genomic_positions.txt \
        --vcf input.vcf(.gz) \
        [--output_dir output_directory]
```
 
---

## Arguments

| Argument      | Required | Description                                         |
|---------------|----------|-----------------------------------------------------|
| --sequences   | Yes      | Path to haplotype sequences file generated by HaploGI|
| --positions   | Yes      | Path to SNV genomic positions file                  |
| --vcf         | Yes      | Input VCF file to be augmented                      |
| --output      | No       | Output VCF file with HaploGI-phased WGS data        |
| --log         | No       | Optional log file                                   |

---

## Input Files

### ðŸ”¹ `haplotype_sequences.txt`
```bash
16:1052701-1055604 302_0 11111111111111111111 
16:1052701-1055604 302_1 22222212211222211212 
16:1052701-1055604 303_0 11211112112111211121 
16:1052701-1055604 303_1 22222212211222211212
```

- Genomic region in format `chr:start_bp-end_bp`
- Sample ID with haplotype suffix `_0` or `_1`
- Phased sequence string for the region

### ðŸ”¹ `SNV_genomic_positions.txt`
```bash
1052701 3.767099
1052874 3.767696
1053095 3.768460
```

- Physical base pair position for each variant
- Genomic position of the variant in cM

### ðŸ”¹ `unphased_WGS_data.vcf`

- Standard VCF with unphased genotypes

---

## Output Files

### ðŸŸ¢ `HaploGI_phased_WGS_data.vcf`:  
  Filtered, VCF v4.2-compliant output with phased genotypes where possible

### ðŸŸ¢ `log_file.txt`:  
  Summary of processing steps and warnings
   
---

## Example

Unzip the `input_files` directory before running the script. Use the included example inputs to run:

```bash
python create_phased_vcf.py \
        --haplotypes ./input_files/haplotype_sequences.txt \
        --positions ./input_files/chr16_SNV_genomic_positions_B38.txt \
        --vcf ./input_files/1000_Genomes_Project_chr16_unphased.vcf.gz \
        --output_dir ./output_files_test
```
ðŸ“Œ Note: Make sure to create the output directory using mkdir before running the script, if you are specifying --output_dir and it does not already exist.

---

## License

This project is licensed under the **GNU General Public License v3.0 or later** (`GPL-3.0-or-later`).  
It uses the SPDX license identifier `GPL-3.0-or-later` in source files for standardized license declaration.

You can view the full license text at:  
https://www.gnu.org/licenses/gpl-3.0.html

Unless required by applicable law or agreed to in writing, the software is distributed  
**"AS IS"**, without warranties or conditions of any kind, either express or implied.

See the [LICENSE](LICENSE) file in this repository for complete details.

---

## Support

For questions, bug reports, or suggestions, please contact:  
ðŸ“§ nrafscience@gmail.com  
ðŸ”— [GitHub Issues](https://github.com/RafPrograms/HaploGI/issues)

